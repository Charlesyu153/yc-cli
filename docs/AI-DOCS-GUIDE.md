# AI 文档管理系统使用指南

本文档详细说明如何使用 YC-CLI 的 AI 文档管理系统进行任务管理和协作。

---

## 系统概述

AI 文档管理系统是一个专为 AI 辅助开发设计的任务文档管理系统，帮助在长期项目中保持上下文连续性。

### 核心价值

1. **持续上下文**：长期任务不丢失进度
2. **快速恢复**：新会话快速进入状态
3. **知识沉淀**：记录决策和经验
4. **团队协作**：便于交接和协作
5. **规范流程**：AI 协作遵循统一规范

### 核心功能

- 任务文档管理（创建、更新、归档）
- 上下文恢复（长期任务连续性）
- AI 协作规范（统一的工作流程）
- 工具脚本（自动化任务管理）

---

## 目录结构

```
ai-docs/
├── README.md                      # 简要说明
├── QUICKREF.md                    # 快速参考
├── current/                       # 进行中的任务
│   └── {任务名}/
│       └── {任务名}.md           # 任务文档
├── archive/                       # 已完成任务归档
│   └── {任务名}/
│       └── {任务名}.md
└── templates/                     # 模板和工具
    ├── task-template.md          # 任务文档模板
    ├── context-resume-template.md # 上下文恢复模板
    ├── ai-guidelines.md          # AI 协作预设指令
    ├── new-task.sh               # 创建新任务脚本
    ├── export-context.sh         # 导出上下文脚本
    └── archive-task.sh           # 归档任务脚本
```

---

## 快速开始

### 1. 创建新任务

```bash
cd ai-docs/templates
./new-task.sh "任务名称" "负责人"
```

**生成内容**：
- 创建 `ai-docs/current/任务名称/` 目录
- 生成任务文档 `任务名称.md`（基于模板）
- 自动填充任务名称、负责人、创建日期

### 2. 更新任务文档

在任务执行过程中，持续更新任务文档：

```markdown
## 进度追踪

### 已完成
- [x] 步骤1: 描述

### 进行中
- [ ] 步骤2: 描述 (当前进度: 正在实现XX功能)

### 待完成
- [ ] 步骤3: 描述
```

### 3. 归档任务

任务完成后，归档到 archive 目录：

```bash
cd ai-docs/templates
./archive-task.sh "任务名称"
```

---

## 工具脚本详解

### new-task.sh - 创建新任务

**用法**：
```bash
./new-task.sh "任务名称" ["负责人"]
```

**功能**：
- 创建任务目录
- 生成任务文档（基于模板）
- 自动填充元信息

**示例**：
```bash
./new-task.sh "实现用户认证功能" "张三"
```

### export-context.sh - 导出上下文

**用法**：
```bash
./export-context.sh "任务名称"
```

**功能**：
- 导出任务的上下文恢复文档
- 包含任务状态、进度、关键决策
- 用于新会话快速恢复上下文

**生成文件**：
```
ai-docs/current/{任务名}/context-resume-{日期}.md
```

### archive-task.sh - 归档任务

**用法**：
```bash
./archive-task.sh "任务名称"
```

**功能**：
- 将任务从 current/ 移动到 archive/
- 保留完整的任务历史
- 保持工作区整洁

**示例**：
```bash
./archive-task.sh "实现用户认证功能"
```

---

## 任务文档结构

### 基本信息

```markdown
# 任务名称

**负责人**: 张三
**创建日期**: 2026-01-14
**状态**: 进行中 / 已完成
```

### 任务目标

```markdown
## 任务目标

简要描述任务的目标和预期成果。
```

### 进度追踪

```markdown
## 进度追踪

### 已完成
- [x] 步骤1: 描述

### 进行中
- [ ] 步骤2: 描述 (当前进度: XX%)

### 待完成
- [ ] 步骤3: 描述

### 下一步
> 接下来需要：实现步骤2的XX功能，涉及文件 path/to/file.py:line
```

### 关键决策

```markdown
## 关键决策

记录重要的技术决策和原因：

1. **决策**: 使用 JWT 进行身份验证
   - **原因**: 无状态、可扩展
   - **日期**: 2026-01-14
```

### 变更文件清单

```markdown
## 变更文件清单

### 新增文件
| 文件 | 说明 |
|------|------|
| `src/auth/jwt.py` | JWT 认证模块 |

### 修改文件
| 文件 | 修改内容 |
|------|----------|
| `src/api/routes.py:42` | 添加认证中间件 |
```

### 完成总结

```markdown
## 完成总结

### 实现概述
简要描述完成的工作。

### 经验教训
记录经验和教训，便于后续参考。
```

---

## 上下文恢复

### 使用场景

- 会话上下文即将超限
- 需要在新会话中继续任务
- 团队成员交接任务

### 导出上下文

```bash
cd ai-docs/templates
./export-context.sh "任务名称"
```

### 使用上下文恢复文档

在新会话中，提供上下文恢复文档给 AI：

```
请阅读以下上下文恢复文档，继续之前的任务...

[粘贴 context-resume-{日期}.md 的内容]

注意：请遵循 ai-docs/templates/ai-guidelines.md 中的预设指令
```

---

## 与 AI 协作

### 会话开始提示语模板

```
请遵循以下规范进行协作：

1. 阅读任务文档: ai-docs/current/{任务名}/{任务名}.md
2. 遵循 ai-docs/templates/ai-guidelines.md 中的预设指令
3. 特别注意：
   - 禁止使用表情符号
   - 每完成一个步骤后更新文档并 git commit
   - 所有任务完成后归档到 archive 目录
   - 所有代码文件不超过500行，超过即模块化重构
   - 优先使用可用的 Skills

当前需要：[具体描述需求]
```

### 工作流程

#### 阶段 1: 任务启动

1. 阅读任务文档
2. 理解当前状态（进度追踪、下一步、关键决策）
3. 明确当前要做的事

#### 阶段 2: 执行任务

每完成一个步骤后：

1. 更新进度文档
   - 标记已完成的步骤为 `[x]`
   - 更新"进行中"部分
   - 更新"下一步"说明
   - 在"变更文件清单"中记录修改的文件

2. 提交代码到本地仓库
   ```bash
   git add .
   git commit -m "描述性的提交信息

   - 完成的具体工作
   - 修改的关键文件

   Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>"
   ```

#### 阶段 3: 任务完成

1. 填写完成总结
2. 最终提交
3. 归档任务

---

## 最佳实践

### 1. 任务文档管理

- **及时更新**：每完成一步就更新文档
- **详细记录**：记录关键决策和原因
- **清晰描述**：使用清晰的语言描述进度和问题
- **文件引用**：使用 `path/to/file.py:line` 格式引用代码

### 2. 进度追踪

- **细化步骤**：将大任务分解为小步骤
- **标记状态**：明确标记已完成、进行中、待完成
- **更新下一步**：始终保持"下一步"部分是最新的
- **记录进度**：在"进行中"部分记录当前进度百分比

### 3. 关键决策记录

- **记录原因**：不仅记录决策，还要记录原因
- **记录日期**：标注决策的日期
- **记录影响**：说明决策对项目的影响
- **记录替代方案**：记录考虑过但未采用的方案

### 4. 变更文件清单

- **及时更新**：每次修改文件后立即更新
- **精确定位**：使用 `file:line` 格式精确定位修改位置
- **说明修改**：简要说明修改的内容和原因

### 5. 上下文恢复

- **定期导出**：在关键节点导出上下文
- **完整信息**：确保上下文包含所有必要信息
- **测试恢复**：在新会话中测试上下文恢复是否有效

---

## 常见场景

### 场景 1: 开始新任务

```bash
# 1. 创建任务
cd ai-docs/templates
./new-task.sh "实现数据导出功能" "张三"

# 2. 编辑任务文档
vim ../current/实现数据导出功能/实现数据导出功能.md

# 3. 开始与 AI 协作
# 提供任务文档路径给 AI
```

### 场景 2: 继续现有任务

```
请阅读任务文档: ai-docs/current/实现数据导出功能/实现数据导出功能.md

请遵循 ai-docs/templates/ai-guidelines.md 中的预设指令。

当前需要：继续实现CSV导出功能
```

### 场景 3: 任务完成归档

```bash
# 1. 填写完成总结
vim ai-docs/current/实现数据导出功能/实现数据导出功能.md

# 2. 最终提交
git add ai-docs/current/实现数据导出功能/
git commit -m "docs: 完成数据导出功能任务总结"

# 3. 归档任务
cd ai-docs/templates
./archive-task.sh "实现数据导出功能"
```

### 场景 4: 上下文超限

```bash
# 1. 导出上下文
cd ai-docs/templates
./export-context.sh "实现数据导出功能"

# 2. 在新会话中使用
# 将 context-resume-{日期}.md 的内容提供给 AI
```

---

## 检查清单

### 开始任务时
- [ ] 已创建任务文档
- [ ] 已填写任务目标
- [ ] 已理解任务要求
- [ ] 已阅读 AI 协作指令

### 执行任务时
- [ ] 每完成一步就更新文档
- [ ] 每完成一步就 git commit
- [ ] 记录关键决策
- [ ] 更新变更文件清单
- [ ] 保持"下一步"部分最新

### 完成任务时
- [ ] 填写完成总结
- [ ] 执行最终 git commit
- [ ] 归档到 archive 目录
- [ ] 验证归档成功

---

## 常见问题

### Q1: 任务文档应该多详细？

**答**：
- 足够详细以便他人（或未来的自己）理解
- 记录关键决策和原因
- 记录遇到的问题和解决方案
- 不需要记录每一行代码的修改

### Q2: 什么时候应该导出上下文？

**答**：
- 会话上下文即将超限时
- 任务暂停较长时间时
- 需要交接给他人时
- 任务的关键节点时

### Q3: 如何处理多人协作的任务？

**答**：
- 在任务文档中明确分工
- 使用 git 管理文档版本
- 定期同步任务进度
- 记录每个人的贡献

### Q4: 任务文档和代码注释有什么区别？

**答**：
- **任务文档**：记录任务的整体进度、决策、问题
- **代码注释**：解释具体代码的实现细节
- 两者互补，不能相互替代

---

## 快速参考

### 常用命令

```bash
# 创建新任务
cd ai-docs/templates && ./new-task.sh "任务名" "负责人"

# 导出上下文
cd ai-docs/templates && ./export-context.sh "任务名"

# 归档任务
cd ai-docs/templates && ./archive-task.sh "任务名"

# 查看当前任务
ls ai-docs/current/

# 查看已归档任务
ls ai-docs/archive/
```

### 文档路径

- 任务文档：`ai-docs/current/{任务名}/{任务名}.md`
- 任务模板：`ai-docs/templates/task-template.md`
- AI 协作指令：`ai-docs/templates/ai-guidelines.md`
- 上下文恢复模板：`ai-docs/templates/context-resume-template.md`

---

**相关文档**：
- 快速参考：`ai-docs/QUICKREF.md`
- AI 协作指令：`ai-docs/templates/ai-guidelines.md`
- 项目规范：`docs/STANDARDS.md`
- 快速开始：`docs/GETTING-STARTED.md`

**版本**：v1.0.0
**更新日期**：2026-01-14
